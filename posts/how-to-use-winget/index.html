<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>windows 包管理 winget 初体验 - Chunni&#39;s Blog</title><link rel="icon" type="image/png" href=/img/favicon.ico /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="1 前言 2 简介 3 安装 4 使用 4.1 查看帮助 4.2 实践：安装 PowerToys、坚果云 4.3 更新 5 注意事项 5.1 下载速度慢 5.2 安装和卸载 5.3 官方存储库 5.4 安装/升级脚本 参考 1 前言 以前使用过 windows 平台的包管理 scoop 和 chocolatey，但是使用体验并不好，最终还是回归到「官网下载」-&gt; 「安装」 的流程。
今天了解到了微软自家的包管理工具 winget，觉得很有趣，就短暂地试用了下，下面是使用记录。
2 简介 Windows 程序包管理器是一个综合的程序包管理器解决方案，由一个命令行工具和一组用于在 Windows 10 和 Windows 11 上安装应用程序的服务组成。
程序包管理器是一个用于自动安装、升级、配置和使用软件的系统或工具集。 大多数程序包管理器都是设计用于发现和安装开发人员工具。
用户可以在 Windows 10 和 Windows 11 计算机上使用 winget 命令行工具来发现、安装、升级、删除和配置应用程序。 此工具是 Windows 程序包管理器服务的客户端接口。
3 安装 打开「命令提示符」窗口，按下 win&#43;r，输入 cmd。
输入 winget --version，如果已安装，会显示 winget 的版本信息，如我的 cmd 显示：" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="windows 包管理 winget 初体验" />
<meta property="og:description" content="1 前言 2 简介 3 安装 4 使用 4.1 查看帮助 4.2 实践：安装 PowerToys、坚果云 4.3 更新 5 注意事项 5.1 下载速度慢 5.2 安装和卸载 5.3 官方存储库 5.4 安装/升级脚本 参考 1 前言 以前使用过 windows 平台的包管理 scoop 和 chocolatey，但是使用体验并不好，最终还是回归到「官网下载」-&gt; 「安装」 的流程。
今天了解到了微软自家的包管理工具 winget，觉得很有趣，就短暂地试用了下，下面是使用记录。
2 简介 Windows 程序包管理器是一个综合的程序包管理器解决方案，由一个命令行工具和一组用于在 Windows 10 和 Windows 11 上安装应用程序的服务组成。
程序包管理器是一个用于自动安装、升级、配置和使用软件的系统或工具集。 大多数程序包管理器都是设计用于发现和安装开发人员工具。
用户可以在 Windows 10 和 Windows 11 计算机上使用 winget 命令行工具来发现、安装、升级、删除和配置应用程序。 此工具是 Windows 程序包管理器服务的客户端接口。
3 安装 打开「命令提示符」窗口，按下 win&#43;r，输入 cmd。
输入 winget --version，如果已安装，会显示 winget 的版本信息，如我的 cmd 显示：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chunni98.github.io/posts/how-to-use-winget/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-29T13:11:13+08:00" />
<meta property="article:modified_time" content="2023-05-29T13:11:13+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="windows 包管理 winget 初体验"/>
<meta name="twitter:description" content="1 前言 2 简介 3 安装 4 使用 4.1 查看帮助 4.2 实践：安装 PowerToys、坚果云 4.3 更新 5 注意事项 5.1 下载速度慢 5.2 安装和卸载 5.3 官方存储库 5.4 安装/升级脚本 参考 1 前言 以前使用过 windows 平台的包管理 scoop 和 chocolatey，但是使用体验并不好，最终还是回归到「官网下载」-&gt; 「安装」 的流程。
今天了解到了微软自家的包管理工具 winget，觉得很有趣，就短暂地试用了下，下面是使用记录。
2 简介 Windows 程序包管理器是一个综合的程序包管理器解决方案，由一个命令行工具和一组用于在 Windows 10 和 Windows 11 上安装应用程序的服务组成。
程序包管理器是一个用于自动安装、升级、配置和使用软件的系统或工具集。 大多数程序包管理器都是设计用于发现和安装开发人员工具。
用户可以在 Windows 10 和 Windows 11 计算机上使用 winget 命令行工具来发现、安装、升级、删除和配置应用程序。 此工具是 Windows 程序包管理器服务的客户端接口。
3 安装 打开「命令提示符」窗口，按下 win&#43;r，输入 cmd。
输入 winget --version，如果已安装，会显示 winget 的版本信息，如我的 cmd 显示："/>
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://chunni98.github.io/css/main.d902908ac6e0fab67957de5db5aea1b6455b19ae2ca98eac4c95a4a0fdc02238.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://chunni98.github.io/css/dark.c95c5dcf5f32f8b67bd36f7dab66680e068fce2b303087294114aabf7a7c080b.css"  disabled />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://chunni98.github.io/">Chunni&#39;s Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">Archives</a>
		
		<a href="/tags">Tags</a>
		
		<a href="/stories">Stories</a>
		
		<a href="/wiki/">Wiki</a>
		
		<a href="/about">About</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://chunni98.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">windows 包管理 winget 初体验</h1>
			<div class="meta">Posted on May 29, 2023</div>
		</div>
		
		<div class="tldr">
			<strong>tl;dr:</strong>
			试用微软开源的包管理工具 winget 和工具集 PowerToys。
		</div>

		<section class="body">
			<ul>
<li><a href="#1-%E5%89%8D%E8%A8%80">1 前言</a></li>
<li><a href="#2-%E7%AE%80%E4%BB%8B">2 简介</a></li>
<li><a href="#3-%E5%AE%89%E8%A3%85">3 安装</a></li>
<li><a href="#4-%E4%BD%BF%E7%94%A8">4 使用</a>
<ul>
<li><a href="#41-%E6%9F%A5%E7%9C%8B%E5%B8%AE%E5%8A%A9">4.1 查看帮助</a></li>
<li><a href="#42-%E5%AE%9E%E8%B7%B5%E5%AE%89%E8%A3%85-powertoys%E5%9D%9A%E6%9E%9C%E4%BA%91">4.2 实践：安装 PowerToys、坚果云</a></li>
<li><a href="#43-%E6%9B%B4%E6%96%B0">4.3 更新</a></li>
</ul>
</li>
<li><a href="#5-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">5 注意事项</a>
<ul>
<li><a href="#51-%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E6%85%A2">5.1 下载速度慢</a></li>
<li><a href="#52-%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD">5.2 安装和卸载</a></li>
<li><a href="#53-%E5%AE%98%E6%96%B9%E5%AD%98%E5%82%A8%E5%BA%93">5.3 官方存储库</a></li>
<li><a href="#54-%E5%AE%89%E8%A3%85%E5%8D%87%E7%BA%A7%E8%84%9A%E6%9C%AC">5.4 安装/升级脚本</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83">参考</a></li>
</ul>
<h2 id="1-前言">1 前言</h2>
<p>以前使用过 windows 平台的包管理 <a href="https://scoop.sh/">scoop</a> 和
<a href="https://chocolatey.org/">chocolatey</a>，但是使用体验并不好，最终还是回归到「官网下载」-&gt;
「安装」 的流程。</p>
<p>今天了解到了微软自家的包管理工具 winget，觉得很有趣，就短暂地试用了下，下面是使用记录。</p>
<h2 id="2-简介">2 简介</h2>
<blockquote>
<p>Windows 程序包管理器是一个综合的程序包管理器解决方案，由一个命令行工具和一组用于在 Windows 10
和 Windows 11 上安装应用程序的服务组成。</p>
<p>程序包管理器是一个用于自动安装、升级、配置和使用软件的系统或工具集。 大多数程序包管理器都是设计用于发现和安装开发人员工具。</p>
<p>用户可以在 Windows 10 和 Windows 11 计算机上使用 winget 命令行工具来发现、安装、升级、删除和配置应用程序。 此工具是 Windows 程序包管理器服务的客户端接口。</p>
</blockquote>
<h2 id="3-安装">3 安装</h2>
<p>打开「命令提示符」窗口，按下 <code>win+r</code>，输入 <code>cmd</code>。</p>
<p>输入 <code>winget --version</code>，如果已安装，会显示 winget 的版本信息，如我的 <code>cmd</code> 显示：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\???&gt;winget --version
</span></span><span style="display:flex;"><span>v1.4.10173
</span></span></code></pre></div><p>如果提示：「&lsquo;winget&rsquo; 不是内部或外部命令，也不是可运行的程序或批处理文件。」，则需要自行下载，注意，
winget 命令行工具仅在 Windows 10 1709（版本 16299）或更高版本上受支持。</p>
<p>可以在 <a href="6">MicrosoftStore</a> 安装。</p>
<p>也可以<a href="https://learn.microsoft.com/zh-cn/windows/package-manager/winget/#install-winget-preview-version-developers-only">安装预览版</a>或者<a href="https://learn.microsoft.com/zh-cn/windows/package-manager/winget/#install-winget-on-windows-sandbox">在 Windows 沙盒上安装 winget</a>。</p>
<h2 id="4-使用">4 使用</h2>
<h3 id="41-查看帮助">4.1 查看帮助</h3>
<p>可以在命令行提示符中键入 <code>winget --help</code> 查看使用帮助。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Windows 程序包管理器 v1.4.10173
</span></span><span style="display:flex;"><span>版权所有 (C) Microsoft Corporation。保留所有权利。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WinGet 命令行实用工具可从命令行安装应用程序和其他程序包。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>使用情况: winget [&lt;命令&gt;] [&lt;选项&gt;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>下列命令有效:
</span></span><span style="display:flex;"><span>  install    安装给定的程序包
</span></span><span style="display:flex;"><span>  show       显示包的相关信息
</span></span><span style="display:flex;"><span>  source     管理程序包的来源
</span></span><span style="display:flex;"><span>  search     查找并显示程序包的基本信息
</span></span><span style="display:flex;"><span>  list       显示已安装的程序包
</span></span><span style="display:flex;"><span>  upgrade    显示并执行可用升级
</span></span><span style="display:flex;"><span>  uninstall  卸载给定的程序包
</span></span><span style="display:flex;"><span>  hash       哈希安装程序的帮助程序
</span></span><span style="display:flex;"><span>  validate   验证清单文件
</span></span><span style="display:flex;"><span>  settings   打开设置或设置管理员设置
</span></span><span style="display:flex;"><span>  features   显示实验性功能的状态
</span></span><span style="display:flex;"><span>  export     导出已安装程序包的列表
</span></span><span style="display:flex;"><span>  import     安装文件中的所有程序包
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>如需特定命令的更多详细信息，请向其传递帮助参数。 [-?]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>下列选项可用：
</span></span><span style="display:flex;"><span>  -v,--version              显示工具的版本
</span></span><span style="display:flex;"><span>  --info                    显示工具的常规信息
</span></span><span style="display:flex;"><span>  -?,--help                 显示选定命令的帮助信息
</span></span><span style="display:flex;"><span>  --wait                    提示用户在退出前按任意键
</span></span><span style="display:flex;"><span>  --verbose,--verbose-logs  启用 WinGet 的详细日志记录
</span></span><span style="display:flex;"><span>  --disable-interactivity   禁用交互式提示
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>可在此找到更多帮助: &#34;https://aka.ms/winget-command-help&#34;
</span></span></code></pre></div><p>示例：使用 <code>winget upgrade --help</code> ：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\???&gt;winget upgrade --help
</span></span><span style="display:flex;"><span>Windows 程序包管理器 v1.4.10173
</span></span><span style="display:flex;"><span>版权所有 (C) Microsoft Corporation。保留所有权利。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>升级通过搜索已安装的包列表或直接从清单中找到的所选包。默认情况下，查询必须以不区分大小写方式匹配包的 ID、名称或名字对象。可通过传递相应的选项来使用其他字段。如果未提供参数，则显示具有可用升级的包
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>使用情况: winget upgrade [[-q] &lt;query&gt;] [&lt;选项&gt;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>以下命令别名可用：
</span></span><span style="display:flex;"><span>  update
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>以下参数可用：
</span></span><span style="display:flex;"><span>  -q,--query                           用于搜索程序包的查询
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>下列选项可用：
</span></span><span style="display:flex;"><span>  -m,--manifest                        程序包清单的路径
</span></span><span style="display:flex;"><span>  --id                                 按 id 筛选结果
</span></span><span style="display:flex;"><span>  --name                               按名称筛选结果
</span></span><span style="display:flex;"><span>  --moniker                            按名字对象筛选结果
</span></span><span style="display:flex;"><span>  -v,--version                         使用指定的版本；默认为最新版本
</span></span><span style="display:flex;"><span>  -s,--source                          使用指定的源查找程序包
</span></span><span style="display:flex;"><span>  -e,--exact                           使用精确匹配查找程序包
</span></span><span style="display:flex;"><span>  -i,--interactive                     请求交互式安装；可能需要用户输入
</span></span><span style="display:flex;"><span>  -h,--silent                          请求无提示安装
</span></span><span style="display:flex;"><span>  --purge                              删除包目录中的所有文件和目录(可移植)
</span></span><span style="display:flex;"><span>  -o,--log                             日志位置（如果支持）
</span></span><span style="display:flex;"><span>  --override                           覆盖待传递的参数至安装程序
</span></span><span style="display:flex;"><span>  -l,--location                        要安装到的位置（如支持）
</span></span><span style="display:flex;"><span>  --scope                              (用户或计算机)选择已安装的包范围筛选器
</span></span><span style="display:flex;"><span>  -a,--architecture                    选择要安装的体系结构
</span></span><span style="display:flex;"><span>  --locale                             要使用的区域设置(BCP47 格式)
</span></span><span style="display:flex;"><span>  --ignore-security-hash               忽略安装程序哈希检查失败
</span></span><span style="display:flex;"><span>  --ignore-local-archive-malware-scan  忽略在从本地清单安装存档类型包时执行的恶意软件扫描
</span></span><span style="display:flex;"><span>  --accept-package-agreements          接受包的所有许可协议
</span></span><span style="display:flex;"><span>  --accept-source-agreements           在源操作期间接受所有源协议
</span></span><span style="display:flex;"><span>  --header                             可选的 Windows-Package-Manager REST 源 HTTP 标头
</span></span><span style="display:flex;"><span>  -r,--recurse,--all                   如果可用，将所有已安装的程序包更新为最新版本
</span></span><span style="display:flex;"><span>  -u,--unknown,--include-unknown       即使无法确定其当前版本，也可升级包
</span></span><span style="display:flex;"><span>  --force                              直接运行命令并继续处理与安全无关的问题
</span></span><span style="display:flex;"><span>  -?,--help                            显示选定命令的帮助信息
</span></span><span style="display:flex;"><span>  --wait                               提示用户在退出前按任意键
</span></span><span style="display:flex;"><span>  --verbose,--verbose-logs             启用 WinGet 的详细日志记录
</span></span><span style="display:flex;"><span>  --disable-interactivity              禁用交互式提示
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>可在此找到更多帮助: &#34;https://aka.ms/winget-command-upgrade&#34;
</span></span></code></pre></div><h3 id="42-实践安装-powertoys坚果云">4.2 实践：安装 PowerToys、坚果云</h3>
<p><strong>介绍</strong></p>
<p>Microsoft PowerToys 是一组实用工具，可帮助高级用户调整和简化其 Windows 体验，从而提高工作
效率，由微软团队开发并开源。</p>
<p>有包括但不限于：Always on Top、颜色选取器、图像大小调整器、文本提取器等功能。</p>
<p>详细内容可见 <a href="https://learn.microsoft.com/zh-cn/windows/powertoys/">Microsoft Learn - Microsoft PowerToys：用于自定义 Windows 的实用工具</a>。</p>
<p>坚果云是国内领先的同步网盘，特点：</p>
<ol>
<li>任意文件夹同步</li>
<li>畅享移动办公</li>
<li>智能增量同步</li>
<li>闪电下载</li>
<li>文件自动锁定</li>
<li>链接优质软件</li>
<li>企业知识管理</li>
<li>团队权限设置</li>
</ol>
<p>详细内容见：<a href="https://www.jianguoyun.com/">坚果云</a></p>
<p><strong>step1. 查找程序包</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>C:\Users\???&gt;winget search PowerToys
</span></span><span style="display:flex;"><span>名称                ID                  版本    源
</span></span><span style="display:flex;"><span>--------------------------------------------------------
</span></span><span style="display:flex;"><span>Microsoft PowerToys XP89DCGQ3K6VLD      Unknown msstore
</span></span><span style="display:flex;"><span>PowerToys (Preview) Microsoft.PowerToys 0.70.0  winget
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Users\aihli&gt;winget search 坚果云
</span></span><span style="display:flex;"><span>名称              ID                        版本  匹配        源
</span></span><span style="display:flex;"><span>--------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Nutstore LightApp Nutstore.NutstoreLightApp 2.0.3 Tag: 坚果云 winget
</span></span></code></pre></div><p>可以看到，PowerToys 软件包的源有两个：Microsoft Store 和 winget。</p>
<p>如果在指定源查找程序包则使用 <code>winget search xxx --source winget/msstore</code> 命令。</p>
<p><strong>step2. 安装</strong></p>
<p>执行 <code>winget install PowerToys --source winget</code> 命令，从 winget 源安装。</p>
<p>如果要从微软商店安装，则运行 <code>winget install PowerToys --source msstore</code>。</p>
<p><img src="https://learn.microsoft.com/zh-cn/windows/package-manager/winget/images/install.png" alt=""></p>
<p><img src="/img/how-to-use-winget/9.png" alt=""></p>
<p><img src="/img/how-to-use-winget/5.png" alt=""></p>
<p><strong>step3. 卸载</strong></p>
<p>以坚果云（Nutstore）为例：</p>
<p><img src="/img/how-to-use-winget/6.png" alt=""></p>
<h3 id="43-更新">4.3 更新</h3>
<p>运行 <code>winget --list</code> 命令，可以看到 Notepad++、Postman、Vim、Wireshark、腾讯QQ、坚果云
有可用的新版本。</p>
<p><img src="/img/how-to-use-winget/1.png" alt=""></p>
<p>这里以网易有道翻译为例，进行升级。</p>
<p><img src="/img/how-to-use-winget/7.png" alt=""></p>
<h2 id="5-注意事项">5 注意事项</h2>
<h3 id="51-下载速度慢">5.1 下载速度慢</h3>
<p>微软并未将软件存储在服务器上，只是在服务器上存储软件官网的下载地址，所以在下载某些软件时，
可能无法下载或者下载速度极慢，这些等属于正常现象，比如 <code>PowerToys</code> 是从 github 下载 。</p>
<p>因此给 <code>winget</code> 更换镜像源没有任何意义，并不会加速下载。</p>
<p><img src="https://pic1.zhimg.com/v2-a8fc1faf02503333b7f13b5acb8d1850.webp" alt="图源：少数派"></p>
<h3 id="52-安装和卸载">5.2 安装和卸载</h3>
<p>目前 winget 安装和卸载仍然是调用软件本身的 <code>setup.exe</code> 和 <code>uninstall.exe</code>。</p>
<h3 id="53-官方存储库">5.3 官方存储库</h3>
<p>地址：<a href="https://github.com/microsoft/winget-pkgs">winget-pkgs</a></p>
<p>微软团队强烈建议用户为喜欢的应用程序提交清单：</p>
<blockquote>
<p>You are highly encouraged to submit manifests for your favorite application.</p>
<p>&ndash; Microsoft</p>
</blockquote>
<h3 id="54-安装升级脚本">5.4 安装/升级脚本</h3>
<p>从文章《<a href="https://sspai.com/post/80027">一日一技 | 无需「XX 管家」，用 Windows 自带工具搞定应用安装与升级</a>》看到 winget 的
一个小应用，觉得很有意思：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bat" data-lang="bat"><span style="display:flex;"><span>@<span style="color:#66d9ef">echo</span> off
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem Get the app name from the user.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">/p</span> appname=输入你想安装或升级的应用名称：
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem Check if the app is installed.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem If it is, upgrade it.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem If it is not, install it.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem If there are multiple app packages from different sources, set the winget source to only &#34;winget&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem This will ensure that the app is installed from the official Microsoft repository.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#66d9ef">exist</span> <span style="color:#e6db74">&#34;</span>%appname%<span style="color:#e6db74">&#34;</span> (
</span></span><span style="display:flex;"><span>winget upgrade <span style="color:#e6db74">&#34;</span>%appname%<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">else</span> (
</span></span><span style="display:flex;"><span>winget install <span style="color:#e6db74">&#34;</span>%appname%<span style="color:#e6db74">&#34;</span> --source winget
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem Display a success message.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> %appname% 已成功安装/升级。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">rem Keep the command line window open and let the user to exit with any key.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pause</span>
</span></span></code></pre></div><blockquote>
<p>顺手将这个记事本文件另存为「你喜欢的名字.bat」。注意，如果像上方实例一样在 set /p appname=
这里用了中文，保存时记得将编码设置为 ANSI 避免乱码。</p>
<p>接下来你只需要把这个文件留在朋友或长辈的电脑上，想尽办法让他们不要删，并且让他们需要的时候双击
运行一下即可。</p>
<p>无论是新应用安装还是已安装应用升级，这个小文件均能搞定，用起来也颇有当年某些 Ghost 操作系统
安装后清理小脚本的味道，如果你爸和我爸一个年纪，应该也会喜欢且信任这种脚本：</p>
<p>&ndash; <a href="https://sspai.com/u/clyde/updates">克莱德</a></p>
</blockquote>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://learn.microsoft.com/zh-cn/windows/package-manager/">Microsoft Learn - Windows 程序包管理器</a></li>
<li><a href="https://github.com/microsoft/PowerToys">PowerTyos 源代码</a></li>
<li><a href="https://github.com/microsoft/winget-cli">winget-cli 源代码</a></li>
<li><a href="https://www.zhihu.com/question/395989844/answer/1933043966">如何看待微软推出 Windows 官方包管理器 winget？ - 老板软件的回答 - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/343053500">Windows 也有包管理工具？</a></li>
</ul>
<hr>
<p>留言或评论请使用 <a href="https://github.com/chunni98/chunni98.github.io/issues">Github Issues</a>。</p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/windows">windows</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/chunni98" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://space.bilibili.com/11612100" rel="me" title="bilibili"><i data-feather="link"></i></a>
    <a class="border"></a><a class="soc" href="https://www.douban.com/people/spring-soil/?_i=6342304DLydoCo" rel="me" title="douban"><i data-feather="link"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2023  © 春泥 |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
  feather.replace()
</script></div>
    </body>
</html>
